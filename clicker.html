<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>clicker</title>
<style>
  :root{
    --bg:#0c0c0c;
    --panel:#121212;
    --accent:#ff3040;
    --muted:#9a9a9a;
    --glass: rgba(255,255,255,0.03);
  }
  html,body{height:100%;margin:0;font-family:"Courier New",monospace;background:var(--bg);color:#fff}
  .wrap{min-height:100%;display:grid;place-items:center;padding:20px}
  .card{
    width:min(820px,96vw);
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:2px solid var(--accent);
    border-radius:8px;
    padding:16px;
    display:grid;
    grid-template-columns: 1fr 320px;
    gap:16px;
    box-sizing:border-box;
  }
  .left{display:flex;flex-direction:column;align-items:center;gap:12px;padding:8px}
  .big-button{
    width:min(420px,72vw);
    height:min(240px,42vh);
    background:linear-gradient(180deg,#1b1b1b,#0e0e0e);
    border:3px solid var(--accent);
    border-radius:12px;
    display:grid;
    place-items:center;
    font-size: clamp(28px, 6vw, 56px);
    cursor:pointer;
    user-select:none;
    transition:transform .08s ease, box-shadow .12s;
    box-shadow:0 6px 24px rgba(255,48,64,0.08);
  }
  .big-button:active{transform:scale(.99);box-shadow:0 3px 12px rgba(0,0,0,0.6)}
  .score-row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .score-card{
    background:var(--glass);
    padding:10px 12px;
    border:1px solid rgba(255,255,255,0.04);
    border-radius:6px;
    min-width:120px;
    text-align:center;
  }
  .score-value{font-weight:bold;font-size:1.6em;color:var(--accent)}
  .right{display:flex;flex-direction:column;gap:8px}
  .panel{background:#0d0d0d;padding:10px;border-radius:6px;border:1px solid rgba(255,255,255,0.03)}
  .title{color:var(--accent);font-weight:bold;margin-bottom:6px}
  .shop-list{display:flex;flex-direction:column;gap:8px; max-height:220px; overflow-y:auto; padding-right:6px;}

  /* themed scrollbars for webkit */
  .shop-list::-webkit-scrollbar { width: 10px; }
  .shop-list::-webkit-scrollbar-track { background: rgba(255,255,255,0.02); border-radius:6px; }
  .shop-list::-webkit-scrollbar-thumb { background: linear-gradient(180deg, #ff707a, #ff3040); border-radius:6px; border:2px solid rgba(0,0,0,0.25); }

  /* global small scrollbar for body too */
  body::-webkit-scrollbar { width: 12px; height: 12px; }
  body::-webkit-scrollbar-track { background: #070707; }
  body::-webkit-scrollbar-thumb { background: linear-gradient(180deg,#ff5866,#ff3040); border-radius:10px; }

  /* Firefox */
  .shop-list { scrollbar-width: thin; scrollbar-color: #ff3040 rgba(255,255,255,0.02); }
  body { scrollbar-width: thin; scrollbar-color: #ff3040 #070707; }

  .muted{color:var(--muted);font-size:0.9em}
  .controls{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
  .btn{background:transparent;color:var(--accent);border:2px solid var(--accent);padding:6px 10px;border-radius:6px;cursor:pointer}
  .small{font-size:0.9em;padding:6px 8px}
  footer{margin-top:8px;color:var(--muted);font-size:0.85em;text-align:center}
  @media (max-width:840px){.card{grid-template-columns:1fr;}.right{order:-1}}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="application" aria-label="Clicker game">
      <div class="left">
        <div class="score-row" style="width:100%;justify-content:center">
          <div class="score-card">
            <div class="muted">Score</div>
            <div id="score" class="score-value">0</div>
          </div>
          <div class="score-card">
            <div class="muted">Per Click</div>
            <div id="perClick" class="score-value">1</div>
          </div>
          <div class="score-card">
            <div class="muted">CPS</div>
            <div id="cps" class="score-value">0</div>
          </div>
        </div>

        <div id="clickBtn" class="big-button" role="button" tabindex="0" aria-pressed="false" aria-label="Click to earn points">
          <div id="bigText">CLICK</div>
        </div>

        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:center;width:100%">
          <button id="resetBtn" class="btn small">Reset</button>
          <a class="btn small" href="index.html">Back</a>
          <div class="muted" style="margin-left:8px">Shortcuts: Space=Click · A = Buy Auto · M = Buy Mult</div>
        </div>

        <footer>spookitys clicker — autosaves every 3s</footer>
      </div>

      <div class="right">
        <div class="panel">
          <div class="title">Programs</div>
          <div class="shop-list" id="programShop">
            <!-- program items injected by JS -->
          </div>
        </div>

        <div class="panel">
          <div class="title">Stats & Actions</div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div class="muted">Total Clicks</div>
            <div id="totalClicks">0</div>
          </div>
          <div style="height:8px"></div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div class="muted">Programs</div>
            <div id="programCount">0</div>
          </div>

          <div class="controls">
            <!-- replaced individual buy buttons with bulk actions -->
            <button id="buyAllPrograms" class="btn small">Buy All Programs</button>
            <button id="buyAllUpgrades" class="btn small">Buy All Upgrades</button>
          </div>
        </div>

        <div class="panel">
          <div class="title">Upgrades</div>
          <div class="shop-list" id="upgradeShop">
            <!-- upgrade items injected by JS -->
          </div>
        </div>

        <div class="panel">
          <div class="title">Help</div>
          <div class="muted">Click the big button to earn points. Buy Programs to gain passive CPS. Buy Upgrades to improve per-click value or other effects. Costs scale with purchases. Press Esc to return.</div>
        </div>
      </div>
    </div>
  </div>

<script>
  // filepath: c:\Users\ginge\Downloads\clicker.html
  // Items map: program vs upgrade entries
  const KEY = 'alpha_clicker_v1';
  const defaultState = {
    score: 0,
    perClick: 1,
    totalClicks: 0,
    bought: {} // counts per itemKey
  };

  // Items: key => { category, name, baseCost, cps/add/mult, description, oneTime? }
  const ITEMS = {
    // Programs (passive CPS)
    auto: { category: 'program', name: 'Auto-Clicker', baseCost: 25, cps: 1, desc: 'Adds 1 CPS' },
    miner: { category: 'program', name: 'Miner Script', baseCost: 60, cps: 2, desc: 'Adds 2 CPS' },
    scanner: { category: 'program', name: 'Packet Scanner', baseCost: 140, cps: 5, desc: 'Adds 5 CPS' },
    helper: { category: 'program', name: 'Background Helper', baseCost: 320, cps: 12, desc: 'Adds 12 CPS' },

    // Upgrades (one-time purchases)
    mult: { category: 'upgrade', name: 'Multiplier', baseCost: 50, multiplier: 1.5, desc: 'x1.5 per purchase', oneTime: true },
    boost: { category: 'upgrade', name: 'Click Boost', baseCost: 30, add: 1, desc: '+1 per click', oneTime: true },
    precision: { category: 'upgrade', name: 'Precision', baseCost: 120, multiplier: 1.2, desc: 'x1.2 per purchase', oneTime: true }
  };

  let state = loadState();

  // DOM
  const scoreEl = document.getElementById('score');
  const perClickEl = document.getElementById('perClick');
  const cpsEl = document.getElementById('cps');
  const totalClicksEl = document.getElementById('totalClicks');
  const programCountEl = document.getElementById('programCount');
  const clickBtn = document.getElementById('clickBtn');
  const programShopEl = document.getElementById('programShop');
  const upgradeShopEl = document.getElementById('upgradeShop');
  const buyAllProgramsBtn = document.getElementById('buyAllPrograms');
  const buyAllUpgradesBtn = document.getElementById('buyAllUpgrades');
  const resetBtn = document.getElementById('resetBtn');

  // Helpers
  function format(n){ return Math.floor(n); }

  function costFor(key){
    const times = state.bought[key] || 0;
    const base = ITEMS[key].baseCost;
    return Math.max(1, Math.round(base * Math.pow(1.6, times)));
  }

  function totalCPS(){
    let cps = 0;
    for (const key in ITEMS){
      if (ITEMS[key].cps) {
        const count = state.bought[key] || 0;
        cps += count * ITEMS[key].cps;
      }
    }
    return cps;
  }

  function programCount(){
    let sum = 0;
    for (const key in ITEMS){
      if (ITEMS[key].category === 'program') sum += (state.bought[key] || 0);
    }
    return sum;
  }

  function updateUI(){
    scoreEl.textContent = format(state.score);
    perClickEl.textContent = (state.perClick % 1 === 0) ? state.perClick : state.perClick.toFixed(2);
    cpsEl.textContent = totalCPS().toFixed(2);
    totalClicksEl.textContent = state.totalClicks;
    programCountEl.textContent = programCount();
    renderShops();
  }

  function renderShops(){
    programShopEl.innerHTML = '';
    upgradeShopEl.innerHTML = '';

    for (const key in ITEMS){
      const item = ITEMS[key];

      // Skip upgrade if oneTime and already purchased
      if (item.category === 'upgrade' && item.oneTime && (state.bought[key] || 0) > 0) continue;

      const cost = costFor(key);
      const el = makeShopItem(item.name, item.desc, cost, key);
      if (item.category === 'program') programShopEl.appendChild(el);
      else upgradeShopEl.appendChild(el);
    }
  }

  function makeShopItem(title, desc, cost, key){
    const wrap = document.createElement('div');
    wrap.className = 'shop-item';
    const left = document.createElement('div');
    left.innerHTML = `<div style="font-weight:bold">${title}</div><div class="muted" style="font-size:0.9em">${desc}</div>`;
    const right = document.createElement('div');
    right.style.display = 'flex';
    right.style.gap = '8px';
    right.style.alignItems='center';
    const costEl = document.createElement('div');
    costEl.className = 'muted';
    costEl.textContent = cost;

    const btn = document.createElement('button');
    const item = ITEMS[key];

    // determine button state
    if (item.category === 'upgrade' && item.oneTime && (state.bought[key] || 0) > 0) {
      btn.textContent = 'Purchased';
      btn.disabled = true;
    } else {
      btn.textContent = state.score >= cost ? 'Buy' : 'Insufficient';
      btn.disabled = state.score < cost;
      btn.addEventListener('click', () => buy(key));
    }

    right.appendChild(costEl);
    right.appendChild(btn);
    wrap.appendChild(left);
    wrap.appendChild(right);
    return wrap;
  }

  // Actions
  function clickAction(){
    state.score += state.perClick;
    state.totalClicks += 1;
    popClickAnim();
    saveStateDebounced();
    updateUI();
  }

  function buy(key){
    const c = costFor(key);
    if (state.score < c) return;
    const item = ITEMS[key];

    // If one-time upgrade and already owned, bail
    if (item.oneTime && (state.bought[key] || 0) > 0) return;

    state.score -= c;
    // upgrades that are oneTime set to 1, programs increment
    if (item.oneTime) state.bought[key] = 1;
    else state.bought[key] = (state.bought[key] || 0) + 1;

    // apply effects for upgrades directly; programs provide passive CPS via counts
    if (item.category === 'upgrade') {
      if (item.multiplier) {
        state.perClick = +(state.perClick * item.multiplier).toFixed(4);
      }
      if (item.add) {
        state.perClick = +(state.perClick + item.add).toFixed(4);
      }
    }

    saveStateDebounced();
    updateUI();
  }

  // Buy all programs (most expensive first, buy repeatedly while affordable)
  function buyAllPrograms(){
    // collect program keys sorted by current cost descending
    const programKeys = Object.keys(ITEMS).filter(k => ITEMS[k].category === 'program');
    // repeatedly attempt purchases prioritizing highest base cost (or dynamic cost)
    // sort by current cost descending each iteration to prioritize expensive ones
    let anyBought = false;
    while (true) {
      // compute affordable option with highest cost
      const affordable = programKeys
        .map(k => ({ key: k, cost: costFor(k) }))
        .filter(x => x.cost <= state.score)
        .sort((a,b) => b.cost - a.cost);
      if (affordable.length === 0) break;
      // buy the most expensive affordable once
      buy(affordable[0].key);
      anyBought = true;
    }
    if (anyBought) saveStateDebounced();
    updateUI();
  }

  // Buy all upgrades (buy any one-time upgrades that are affordable)
  function buyAllUpgrades(){
    // attempt purchases; prefer cheaper first so you can buy more upgrades
    const upgradeKeys = Object.keys(ITEMS).filter(k => ITEMS[k].category === 'upgrade' && ITEMS[k].oneTime && !(state.bought[k]||0));
    // sort ascending cost
    upgradeKeys.sort((a,b) => costFor(a) - costFor(b));
    let any = false;
    for (const k of upgradeKeys) {
      const c = costFor(k);
      if (state.score >= c) {
        buy(k);
        any = true;
      }
    }
    if (any) saveStateDebounced();
    updateUI();
  }

  function resetState(){
    if (!confirm('Reset all progress?')) return;
    state = JSON.parse(JSON.stringify(defaultState));
    saveState();
    updateUI();
  }

  // Auto-click loop (applies CPS * perClick continuously)
  let lastTick = performance.now();
  function tick(now){
    const dt = now - lastTick;
    lastTick = now;
    const cps = totalCPS();
    if (cps > 0) {
      const clicks = (cps * dt) / 1000;
      state.score += clicks * state.perClick;
    }
    requestAnimationFrame(tick);
  }

  function popClickAnim(){
    clickBtn.animate([
      { transform: 'scale(1)' },
      { transform: 'scale(0.98)' },
      { transform: 'scale(1)' }
    ], { duration: 120, easing: 'ease-out' });
  }

  // Persistence
  function saveState(){
    try { localStorage.setItem(KEY, JSON.stringify(state)); } catch(e){}
  }
  let saveTimer = null;
  function saveStateDebounced(){
    if (saveTimer) clearTimeout(saveTimer);
    saveTimer = setTimeout(saveState, 600);
  }
  function loadState(){
    try {
      const raw = localStorage.getItem(KEY);
      if (raw) {
        const parsed = JSON.parse(raw);
        return Object.assign({}, defaultState, parsed);
      }
    } catch(e){}
    return Object.assign({}, defaultState);
  }

  // UI wiring
  clickBtn.addEventListener('click', clickAction);
  clickBtn.addEventListener('keydown', (e)=>{ if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); clickAction(); }});
  buyAllProgramsBtn.addEventListener('click', buyAllPrograms);
  buyAllUpgradesBtn.addEventListener('click', buyAllUpgrades);
  resetBtn.addEventListener('click', resetState);

  // Keyboard shortcuts (A -> auto program, M -> multiplier upgrade)
  document.addEventListener('keydown', (e)=>{
    if (e.key === ' ') { e.preventDefault(); clickAction(); }
    else if (e.key.toLowerCase() === 'a') { buy('auto'); }
    else if (e.key.toLowerCase() === 'm') { buy('mult'); }
    else if (e.key === 'Escape') { window.location.href = 'index.html'; }
  });

  // Autosave interval
  setInterval(()=>saveState(), 3000);

  // Initialize UI and start loops
  updateUI();
  lastTick = performance.now();
  requestAnimationFrame(tick);
</script>
</body>
</html>
